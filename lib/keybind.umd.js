!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).keybind=e()}(this,(function(){"use strict";var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};var e=function(){function t(){this.eventMap={}}return t.prototype.on=function(t,e,n){void 0===n&&(n=null),void 0===this.eventMap[t]&&(this.eventMap[t]=[]),this.eventMap[t].push({fn:e,ctx:n})},t.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(!this.eventMap[t]||!this.eventMap[t].length)throw Error("".concat(t," event is not exist!"));this.eventMap[t].forEach((function(t){t.fn.apply(t.ctx,e)}))},t.prototype.off=function(t,e){if(!e&&this.eventMap[t])delete this.eventMap[t];else{if(!this.eventMap[t])throw Error("".concat(t," event is not exist!"));this.eventMap[t]=this.eventMap[t].filter((function(t){return t.fn!==e}))}},t.prototype.once=function(t,e,n){void 0===n&&(n=null);var o=this;return this.on(t,(function i(){o.off(t,i),e&&e.apply(n,arguments)}),n)},t}(),n=Object.freeze({106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"}),o=Object.freeze({"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"}),i=Object.freeze({8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",124:"f13",125:"f14",126:"f15",127:"f16",128:"f17",129:"f18",130:"f19",224:"meta"}),r=Object.freeze({option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"});function f(t,e,n){return n||(n=function(){if(!s)for(var t in s={},i)Number(t)>95&&Number(t)<112||i.hasOwnProperty(t)&&(s[i[t]]=t);return s}()[t]?"keydown":"keypress"),"keypress"==n&&e.length&&(n="keydown"),n}var s=null;function p(t){return"shift"===t||"ctrl"===t||"alt"===t||"meta"===t}function a(t,e){for(var n,i=[],s=function(t){return"+"===t?["+"]:(t=t.replace(/\+{2}/g,"+plus")).split("+")}(t=t.replace(/\s+/g,"")),a=0;a<s.length;++a)n=s[a],r.hasOwnProperty(n)&&(n=r[n]),"keypress"!==e&&o.hasOwnProperty(n)&&(n=o[n],i.push("shift")),p(n)&&i.push(n);return{key:n,modifiers:i,action:e=f(n,i,e),type:c(n,i,e)}}function c(t,e,n){return(e.length?e.sort().join("+")+"+":"")+t+":"+n}function u(t,e,n){t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent("on"+e,n)}return new(function(e){function o(t){void 0===t&&(t=window);var n=e.call(this)||this;return n.eventSet=new Set,u(t,"keypress",n.keyDownBinding.bind(n)),u(t,"keyup",n.keyDownBinding.bind(n)),u(t,"keydown",n.keyDownBinding.bind(n)),n}return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}(o,e),o.prototype.bind=function(t,e,n){var o=this;void 0===n&&(n=null),"string"==typeof t&&(t=[t]),t.forEach((function(t){return o._bind(t,e,n)}))},o.prototype.unbind=function(t,e,n){var o=this;void 0===n&&(n=null),"string"==typeof t&&(t=[t]),t.forEach((function(t){return o._unbind(t,e,n)}))},o.prototype._bind=function(t,e,n){var o=a(t.toLocaleLowerCase());!1===this.eventSet.has(o.type)&&this.eventSet.add(o.type),this.on(o.type,e,n)},o.prototype._unbind=function(t,e,n){var o=a(t);!e&&this.eventSet.has(o.type)&&this.eventSet.delete(o.type),this.off(o.type,e)},o.prototype.keyDownBinding=function(t){var e,o,r=function(t){if("keypress"==t.type){var e=String.fromCharCode(t.which);return t.shiftKey||(e=e.toLowerCase()),e}return t.which in i?i[t.which]:t.which in n?n[t.which]:String.fromCharCode(t.which).toLowerCase()}(t);r&&this.handleKey(r,(o=[],(e=t).shiftKey&&o.push("shift"),e.altKey&&o.push("alt"),e.ctrlKey&&o.push("ctrl"),e.metaKey&&o.push("meta"),o),t)},o.prototype.handleKey=function(t,e,n){var o=c(t,e,n.type);this.eventSet.has(o)&&this.emit(o,n)},o}(e))}));
